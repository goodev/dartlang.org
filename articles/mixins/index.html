<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Product" xmlns:wb="http://open.weibo.com/wb">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Mixins in Dart | Dart: 用于创建结构化的web应用</title>
  <meta property="wb:webmaster" content="a984f6440858ee44" />
  <meta property="twitter:account_id" content="376585411" />
  <meta itemprop="name" content="Mixins in Dart | Dart: 用于创建结构化的web应用">
  
  <meta itemprop="image" content="https://www.dartlang.org/imgs/dart-logo-900w.png">
  
  <meta itemprop="description" content="Mixins let you implement functionality once and use it in multiple classes.">

  <!-- Bootstrap core CSS -->
  <link href="/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="/css/dart-style.css" rel="stylesheet">
  <link href="/css/prettify.css" type="text/css" rel="stylesheet" />
  <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
  <link href="//fonts.googleapis.com/css?family=Roboto:300,400" rel="stylesheet">
	
	<link rel="author" href="/authors/gilad-bracha.html">
	
	<link rel="alternate" type="application/atom+xml" href="http://news.dartlang.org/feeds/posts/default" title="Atom feed">
  <!-- 
  <link href="https://plus.google.com/109866369054280216564" rel="publisher">
  -->
  <link href="http://weibo.com/cndart" rel="publisher">

  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
  <![endif]-->

  <!-- 
<script type="text/javascript">

  //var _gaq = _gaq || [];
 // _gaq.push(['_setAccount', 'UA-26406144-4']);
  //_gaq.push(['_setDomainName', 'dartlang.org']);
  //_gaq.push(['_setSiteSpeedSampleRate', 50]);
  //_gaq.push(['_trackPageview']);

 // (function() {
   // var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
   // ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   // var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 // })();

</script>
-->


  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script>
  

<!-- 
	window.___gcfg = {lang: 'en'};
	(function()
	{var po = document.createElement("script");
	po.type = "text/javascript"; po.async = true;po.src = "https://apis.google.com/js/plusone.js";
	var s = document.getElementsByTagName("script")[0];
	s.parentNode.insertBefore(po, s);
	})();
-->
  </script>
<!-- 
  <script>
    window.twttr = (function (d,s,id) {
      var t, js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
      js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
      return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
    }(document, "script", "twitter-wjs"));
  </script>
-->
  <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
</head>
<body onload="prettyPrint()">
    <div class="navbar navbar-fixed-top navbar-inverse" role="navigation">
      <div class="container">
        
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><i class="sprite-icon-dart-logo"></i></a>
        </div>

        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
           <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                                       入门
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/codelabs/darrrt/">试试 Dart</a></li>
                <li><a href="/docs/tutorials/">Dart 教程</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                                文档
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/docs/">开发者指南</a></li>
                <li><a href="http://api.dartlang.org">API 参考</a></li>
                <li><a href="/docs/spec/">语言规范</a></li>

                <li class="divider"></li>
                <li><a href="/docs/dart-up-and-running/">Dart: Up and Running</a></li>
                <li><a href="/books/">更多图书</a></li>

                <li class="divider"></li>
                <li><a href="/articles/">文章</a></li>
                <li><a href="/support/faq.html">FAQ</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                       工具
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/docs/dart-up-and-running/contents/ch04-tools-dart2js.html">dart2js</a>
                </li><li><a href="/tools/editor/">Dart Editor</a></li>
                <li><a href="http://pub.dartlang.org/">Pub Package Manager</a></li>
                <li><a href="/tools/">更多工具</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                                     资源
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/samples/">示例代码</a></li>
                <li><a href="http://synonym.dartlang.org/">Translations from Dart</a></li>
                <li><a href="http://try.dartlang.org/">Try Dart!</a></li>

                <li class="divider"></li>
                <li><a href="/slides/">演示文稿</a></li>
                <li><a href="/dart-tips/">Dart 短视频</a></li>

                <li class="divider"></li>
                <li><a href="http://code.google.com/p/dart/issues/list">Bugs and Feature Requests</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                              社区
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/support/">支持和社区资源</a></li>
                <li><a href="http://code.google.com/p/dart/wiki/Contributing">Contributor's Guide</a></li>
              </ul>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li>
              <form class="navbar-search" action="/search.html" id="cse-search-box">
                <input type="hidden" name="cx" value="011220921317074318178:i4mscbaxtru">
                <input type="hidden" name="ie" value="UTF-8">
                <input type="hidden" name="hl" value="en">
                <input type="search" name="q" class="search-query placeholder-position-fix form-control" id="q" autocomplete="off" placeholder="Search">
              </form>
            </li>
            <li><a target="_blank" href="https://twitter.com/dart_lang" class="btn"><i class="sprite-icon-social-twitter"></i></a></li>
            <li><a target="_blank" href="https://plus.google.com/+dartlang/posts" class="btn"><i class="sprite-icon-social-gplus"></i></a></li>
            <li><a target="_blank" href="http://weibo.com/cndart" class="btn"><i class="sprite-icon-social-weibo"><img src="/imgs/weibo.png"></i></a></li>
          </ul>
        </div><!-- /.nav-collapse -->

      </div><!-- /.container -->
    </div><!-- /.navbar -->

  


<div class="container-page">
  <div class="container">
  	<div class="container sub-page">
      <div class="row">
        <article class="has-permalinks"><div class="col-md-3">
  <div class="bs-sidebar hidden-print affix-top" role="complementary">

<ol class="toc nav bs-sidenav" id="markdown-toc">
  <li><a href="#basic-concepts">Basic concepts</a></li>
  <li><a href="#syntax-and-semantics">Syntax and semantics</a></li>
  <li><a href="#details">Details</a>    <ol>
      <li><a href="#privacy">Privacy</a></li>
      <li><a href="#statics">Statics</a></li>
      <li><a href="#types">Types</a></li>
      <li><a href="#generics">Generics</a></li>
    </ol>
  </li>
</ol>

  </div>
</div>
<div class="col-md-7">
  <p><!-- Start of content -->
	</p>

  <h1 id="mixins-in-dart">Mixins in Dart</h1>

  <p><em>Written by Gilad Bracha <br />
December 2012</em> (Revised November 2013)</p>

  <p>This document describes mixins in Dart.
The semantics are deliberately restricted in several ways,
so as to reduce disruption to our existing implementations,
while allowing future evolution toward a full-fledged mixin implementation.
This restricted version already provides considerable value.</p>

  <h2 id="basic-concepts">Basic concepts</h2>

  <p>If you are familiar with the academic literature on mixins
you can probably skip this section.
Otherwise, please do read it,
as it defines important concepts and notation.
Those wishing to delve deeply into the topic can start with this paper:
<a href="http://www.bracha.org/mixins-paper.pdf">Mixins in Strongtalk</a>.</p>

  <p>In a language supporting classes and inheritance,
a class implicitly defines a <em>mixin</em>.
The mixin is usually implicit—it is defined by the class body,
and constitutes the delta between the class and its superclass.
The class is in fact a <em>mixin application</em>—the
result of applying its implicitly defined mixin to its superclass. </p>

  <p>The term <em>mixin application</em> comes from
a close analogy with <em>function application</em>.
Mathematically, a mixin <em>M</em> can be seen as a function
from superclass to subclass:
feed <em>M</em> a superclass <em>S</em>, and a new subclass of <em>S</em> is returned.
This is often written as <em>M |&gt; S</em> in the research literature.</p>

  <p>Based on the notion of function application,
one can define function composition.
The concept carries through to mixin composition;
we define the composition of mixins
<em>M<sub>1</sub></em> and <em>M<sub>2</sub></em>,
written <em>M<sub>1</sub></em> * <em>M<sub>2</sub></em>, as:
<em>(M<sub>1</sub> * M<sub>2</sub>) |&gt; S =
M<sub>1</sub> |&gt; (M<sub>2</sub> |&gt; S)</em>.</p>

  <p>Functions are useful because
they can be applied to different arguments. 
Likewise mixins.
The mixin implicitly defined by a class
is usually applied only once,
to the superclass given in the class declaration.
To allow mixins to be applied to different superclasses,
we need to be able to either
declare mixins independently of any particular superclass,
or alternately,
to extricate the implicit mixin of a class
and reuse it outside its original declaration.
That is what we propose to do below.</p>

  <h2 id="syntax-and-semantics">Syntax and semantics</h2>

  <p>Mixins are implicitly defined via ordinary class declarations.
In principle, every class defines a mixin that can be extracted from it.
However, in this proposal,
a mixin may only be extracted from a class
that obeys the following restrictions:</p>

  <ol>
    <li>The class has no declared constructors.</li>
    <li>The class’ superclass is Object.</li>
    <li>The class contains no <code>super</code> calls.</li>
  </ol>

  <p>Restriction (1) avoids complications that arise
due to the need to pass constructor parameters up the inheritance chain.
Under those circumstances, 
restriction (2) encourages mixins to be declared explicitly.
Restriction (3) means that implementations can continue
to statically bind <code>super</code> calls rather than either
rebinding them upon mixin application,
or binding them dynamically.</p>

  <p>Example 1:</p>

  <pre class="prettyprint lang-dart">abstract class Collection&lt;E&gt; {
  Collection&lt;E&gt; newInstance();
  Collection&lt;E&gt; map((f) {
    var result = newInstance();
    forEach((E e) { result.add(f(e)); });
    return result;
  }
}

abstract class DOMElementList&lt;E&gt; = DOMList with Collection&lt;E&gt;;

abstract class DOMElementSet&lt;E&gt; = DOMSet with Collection&lt;E&gt;;

// ... 28 more variants</pre>

  <p>Here, Collection&lt;E&gt; is a normal class that is used to declare a mixin.
Both the classes DOMElementList and DOMElementSet are mixin applications.
They are defined by a special form of class declaration that gives them a name
and declares them equal to an application of
a mixin to a superclass, given via a <code>with</code> clause.
The class is abstract
because it does not implement the abstract method 
newInstance() declared in Collection. </p>

  <p>In the above, DOMElementList is effectively
<em>Collection mixin |&gt; DOMList</em>,
while DOMElementSet is <em>Collection mixin |&gt; DOMSet</em>.</p>

  <p>The benefit here is that the code in class Collection
can be shared in multiple class hierarchies.
We list two such hierarchies above—one rooted in DOMList 
and one rooted in DOMSet.
One need not repeat/copy the code in Collection,
and every change made to Collection will propagate to both hierarchies,
greatly easing maintenance of the code.
This particular example is loosely based on a 
real and very acute case in the Dart libraries.</p>

  <p>The above examples illustrate one form of mixin application,
where the mixin application specifies a mixin and a superclass
to which it applies,
and provides the application with a name.</p>

  <p>In an alternative form, mixin applications appear in
the <code>with</code> clause of a class declaration
as a comma-separated list of identifiers.
All the identifiers must denote classes.
In this form, multiple mixins are composed and applied
to the superclass named in the extends clause,
producing an anonymous superclass. 
Taking the same examples again, we would have:</p>

  <pre class="prettyprint lang-dart">class DOMElementList&lt;E&gt; extends DOMList with Collection&lt;E&gt; {
   DOMElementList&lt;E&gt; newInstance() =&gt; new DOMElementList&lt;E&gt;();
}

class DOMElementSet&lt;E&gt; extends DOMSet with Collection&lt;E&gt; {
  DOMElementSet&lt;E&gt; newInstance() =&gt; new DOMElementSet&lt;E&gt;();
}</pre>

  <p>Here, DOMElementList is not the application <em>Collection mixin |&gt; DOMList.</em> 
Instead, it is a new class whose superclass is such an application.
The situation with respect to DOMElementSet is analogous.
Note that in each case,
the abstract method newInstance() is overridden with an implementation,
so these classes can be instantiated directly.</p>

  <p>Consider what happens if DOMList has a non-trivial constructor:</p>

  <pre class="prettyprint lang-dart">class DOMElementList&lt;E&gt; extends DOMList with Collection&lt;E&gt; {
  DOMElementList&lt;E&gt; newInstance() =&gt; new DOMElementList&lt;E&gt;(0);
  DOMElementList(size): super(size);
}</pre>

  <p>Each mixin has its own constructor called independently,
and so does the superclass.
Since a mixin constructor cannot be declared,
the call to it can be elided in the syntax;
in the underlying implementation,
the call can always be placed at the start of the initialization list.</p>

  <p>The constructor would set the values for any fields
and for the generic type parameters.</p>

  <p>This rule ensures that these examples run smoothly
and also generalize cleanly once one lifts restriction (1).</p>

  <p>The second form is a convenient sugar
that allows multiple mixins to be mixed into a class
without the need to introduce multiple intermediate declarations. 
For example:</p>

  <pre class="prettyprint lang-dart">class Person {
  String name;
  Person(this.name);
}

class Maestro extends Person with Musical, Aggressive, Demented {
  Maestro(name):super(name);
}</pre>

  <p>Here, the superclass is the mixin application:</p>

  <p><em>Demented mixin |&gt; Aggressive mixin |&gt; Musical mixin |&gt; Person</em></p>

  <p>We assume that only Person has a constructor with arguments.
Hence <em>Musical mixin |&gt; Person</em> inherits Person’s constructors,
and so on until the actual superclass of Maestro,
which is formed by a series of mixin applications.</p>

  <p>In reality in this example we’d expect that
Demented, Aggressive, and Musical 
actually have interesting properties that are likely to require state. </p>

  <h2 id="details">Details</h2>

  <p>We now discuss a few issues in more detail:</p>

  <ul>
    <li>Privacy</li>
    <li>Statics</li>
    <li>Types</li>
  </ul>

  <h3 id="privacy">Privacy</h3>

  <p>A mixin application may well be declared outside the library
that declared the original class.
This does not have any effect on
who can access members of a mixin application instance.
Access to members is determined based on
the library where they were originally declared,
exactly as with ordinary inheritance. 
This follows from the semantics of mixin application,
which are determined by the semantics of inheritance
in the underlying language.</p>

  <h3 id="statics">Statics</h3>

  <p>Can one use the statics of the original class
via the mixin application or not?<br />
Again, the answer (No) follows from the semantics of inheritance.
Statics are not inherited in Dart. </p>

  <h3 id="types">Types</h3>

  <p>What is the type of a mixin application instance?
In general, it is a subtype of its superclass,
and also supports the methods defined on the mixin.
The mixin name itself, however,
denotes the type of the original class,
which has its own superclass
and may not be compatible with a particular mixin application.</p>

  <p>What about the interfaces a class supports?
Does its mixin support them?
In general, no, since interface support
may rely on inherited functionality.
This implies that a mixin application must declare
what interfaces it implements explicitly.</p>

  <h3 id="generics">Generics</h3>

  <p>If a class has type parameters,
its mixin necessarily has identical type parameters. </p>

</div>

    	  </div> <!-- End of content from toc.html -->
        </article>
	  </div>

	
	<ul class="pager">
	  <li><a href="/articles/">More articles about Dart <i class="glyphicon glyphicon-chevron-up"></i></a></li>
	 </ul>
	 

	</div>
  </div>
</div>

  <footer class="footer container-full">
    <div class="container">
      <div class="row">
        <div class="col-md-5">
          <h3>一种用于创建可扩展 web 应用程序的语言、工具和代码库</h3>
          <p>Dart 是一个 <a href="https://code.google.com/p/dart/">开源项目</a>，由  Google 和其他人员参与。</p>
          <p class="sm">除非注明，该页面内容使用 the Creative Commons Attribution 3.0 License 发布，示例代码使用  BSD License 发布。</p>
          <!-- 
          <p><a class="saelogo" href="http://sae.sina.com.cn/activity/invite/15649/weibo" target="_blank"><img src="http://static.sae.sina.com.cn/image/poweredby/poweredby.png" title="Powered by Sina App Engine"></a></p>     	
          -->
        </div>
        <div class="col-md-2 col-md-offset-1">
          <h4>受欢迎的文章</h4>
          <ul>
            <li><a href="/polymer-dart/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">Polymer.dart</a></li>
            <li><a href="/performance/">性能</a></li>
            <li><a href="/docs/dart-up-and-running/contents/ch02.html?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">语言概览</a> &amp;
            <a href="/docs/dart-up-and-running/contents/ch03.html?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">代码库概览</a></li>
            <li><a href="/samples/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">示例代码</a></li>
            <li><a href="/docs/tutorials/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">教程</a> &amp;
                <a href="/codelabs/darrrt/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">代码实验室</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4>资源</h4>
          <ul>
            <li><a href="http://pub.dartlang.org/">Pub packages</a></li>
            <li><a href="http://synonym.dartlang.org/">Translations from Dart</a></li>
            <li><a href="http://code.google.com/p/dart/issues/list">Dart bugs and feature requests</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4>社区</h4>
          <ul>
            <li><a href="/support/">邮件列表</a></li>
            <li><a href="http://bbs.dartlang.cc">中文社区</a></li>
            <li><a href="https://plus.google.com/communities/114566943291919232850">G+ 社区</a></li>
            <li><a href="https://plus.google.com/+dartlang/posts">G+ 新闻发布频道</a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/dart">Stack Overflow</a></li>
          </ul>
        </div>
      </div>
    </div>
  </footer> <!-- End footer -->

<script type='text/javascript' src='/js/jquery.js'></script>
<script type='text/javascript' src='/js/bootstrap.min.js'></script>
<script type='text/javascript' src='/js/social-event-analytics.js'></script>
<script type='text/javascript' src='/js/prettify.js'></script>
<script type='text/javascript' src='/js/lang-dart.js'></script>
<script type='text/javascript' src='/js/lang-yaml.js'></script>
<script type='text/javascript' src='/js/scripts.js'></script>




<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F76b2695e71e6cec6e6af036d76afa367' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=1&amp;pos=left&amp;uid=590574" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
var bds_config={"bdTop":367};
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
</script>
<!-- Baidu Button END -->
</body>
</html>

