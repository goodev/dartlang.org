<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Product" xmlns:wb="http://open.weibo.com/wb">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Improving the DOM | Dart: 用于创建结构化的web应用</title>
  <meta property="wb:webmaster" content="a984f6440858ee44" />
  <meta property="twitter:account_id" content="376585411" />
  <meta itemprop="name" content="Improving the DOM | Dart: 用于创建结构化的web应用">
  
  <meta itemprop="image" content="https://www.dartlang.org/imgs/dart-logo-wordmark-1200w.png">
  
  <meta itemprop="description" content="Learn how Dart's HTML library improves the browser programming experience.">


  <link rel='stylesheet' type='text/css' href='/css/bootstrap.min.css'>
<link rel='stylesheet' type='text/css' href='/css/dart-style.css'>
<link rel='stylesheet' type='text/css' href='/css/prettify.css'>
<link rel='stylesheet' type='text/css' href='/css/font-awesome.min.css'>

  
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:300,400" rel="stylesheet">

	
	<link rel="author" href="/authors/bob-nystrom.html">
	
	<link rel="alternate" type="application/atom+xml" href="http://dartnews.sinaapp.com/?feed=atom" title="Atom feed">
  <!-- 
  <link href="https://plus.google.com/109866369054280216564" rel="publisher">
  -->
  <link href="http://weibo.com/cndart" rel="publisher">

  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
  <![endif]-->

  <!-- 
<script type="text/javascript">

  //var _gaq = _gaq || [];
 // _gaq.push(['_setAccount', 'UA-26406144-4']);
  //_gaq.push(['_setDomainName', 'dartlang.org']);
  //_gaq.push(['_setSiteSpeedSampleRate', 50]);
  //_gaq.push(['_trackPageview']);

 // (function() {
   // var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
   // ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   // var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 // })();

</script>
-->


  <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
</head>
<body onload="prettyPrint()">
    <div class="navbar navbar-fixed-top navbar-inverse" role="navigation">
      <div class="container">
        
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><i class="sprite-icon-dart-logo"></i></a>
        </div>

        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
           <li class="dropdown">
              <a href="/codelabs/darrrt/" title="Learn Dart in this short code lab.">
                                                       入门
              </a>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                                文档 <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/docs/tutorials/">教程</a></li>
                
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/dart-by-example/">Dart 示例</a></li>
                
                <li class="divider"></li>
                <li><a href="/docs/">开发者指南</a></li>
                <li><a href="http://api.dartlang.org">API 参考</a></li>
                <li><a href="/docs/spec/">语言规范</a></li>

                <li class="divider"></li>
                <li><a href="/docs/dart-up-and-running/">Dart: Up and Running</a></li>
                <li><a href="/books/">更多图书</a></li>

                <li class="divider"></li>
                <li><a href="/articles/">文章</a></li>
                <li><a href="/support/faq.html">FAQ</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                       工具  <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/docs/dart-up-and-running/contents/ch04-tools-dart2js.html">dart2js</a>
                </li><li><a href="/tools/editor/">Dart Editor</a></li>
                <li><a href="http://pub.dartlang.cc/">Pub Package Manager</a></li>
                <li><a href="/tools/">更多工具</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                                     资源  <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="/samples/">示例代码</a></li>
                <li><a href="/docs/synonyms/">和其他语言的相同点</a></li>

                <li class="divider"></li>
                <li><a href="/slides/">演示文稿</a></li>
                <li><a href="/dart-tips/">Dart 短视频</a></li>

                <li class="divider"></li>
                <li><a href="/performance/">性能</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="/support/" title="Community and Support">
                                              支持
              </a>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li>
              <form class="navbar-search" action="/search.html" id="cse-search-box">
                <input type="hidden" name="cx" value="011220921317074318178:i4mscbaxtru">
                <input type="hidden" name="ie" value="UTF-8">
                <input type="hidden" name="hl" value="en">
                <input type="search" name="q" class="search-query placeholder-position-fix form-control" id="q" autocomplete="off" placeholder="Search">
              </form>
            </li>
            <li><a target="_blank" href="https://twitter.com/dart_lang" class="btn"><i class="sprite-icon-social-twitter"></i></a></li>
            <li><a target="_blank" href="https://plus.google.com/+dartlang/posts" class="btn"><i class="sprite-icon-social-gplus"></i></a></li>
            <li><a target="_blank" href="http://weibo.com/cndart" class="btn"><i class="sprite-icon-social-weibo"><img src="/imgs/weibo.png"></i></a></li>
          </ul>
        </div><!-- /.nav-collapse -->

      </div><!-- /.container -->
    </div><!-- /.navbar -->

  


<div class="container-page">
  <div class="container">
  	<div class="container sub-page">
      <div class="row">
        <article class="has-permalinks"><div class="col-md-3">
  <div class="bs-sidebar hidden-print affix-top" role="complementary">

<ol class="toc nav bs-sidenav" id="markdown-toc">
  <li><a href="#simpler-names">Simpler names</a></li>
  <li><a href="#better-querying">Better querying</a></li>
  <li><a href="#real-collections">Real collections</a></li>
  <li><a href="#constructors">Constructors</a></li>
  <li><a href="#events">Events</a></li>
  <li><a href="#no-more-vendor-prefixes">No more vendor prefixes</a></li>
  <li><a href="#future-based-apis">Future-based APIs</a></li>
  <li><a href="#more-granular-libraries">More granular libraries</a></li>
  <li><a href="#cross-browser-consistency">Cross-browser consistency in HTML APIs</a></li>
  <li><a href="#cascades">Cascaded DOM construction</a></li>
  <li><a href="#know-more">Want to know more?</a></li>
</ol>

  </div>
</div>
<div class="col-md-7">
  <p><!-- Start of content -->
	</p>

  <h1 id="improving-the-dom">Improving the DOM</h1>

  <p><em>Written by Bob Nystrom<br />
October 2011 (updated March 2013)</em></p>

  <p>One of the great opportunities a new language gives you is a chance to also
define a cleaner set of APIs for users. When it comes to coding in a browser,
that API is the DOM. The DOM API that JavaScripters suffer is creaking under the
weight of history and technological ballast such as XML.</p>

  <h2 id="simpler-names">Simpler names</h2>

  <p>The simplest changes were just cleaning up some painful names.
<code>HTMLElement</code> is just <code>Element</code> and we’ve dropped
<code>HTML</code> from most of the type names when it makes sense. Instead of
<code>childNodes</code> and <code>elements</code> we have <code>nodes</code> and
<code>children</code>. <code>ownerDocument</code> is just <code>document</code>.
We’ve tried to optimize names so that the things you use the most are the most
terse.</p>

  <p>When’s the last time you use <code>XMLHttpRequest</code> to actually, you
know, request XML? We thought so. So we’ve renamed <code>XMLHttpRequest</code>
to <code>HttpRequest</code>.</p>

  <p>We’ve also made the capitalization of names for DOM types more consistent.
All names containing acronyms with greater than two letters always use
camelCase for capitalization, like
<code>CssStyleSheet</code> (previously known as CSSStyleSheet).</p>

  <h2 id="better-querying">Better querying</h2>

  <p>One area where the DOM has a bunch of baggage is finding elements. Today’s
DOM has a pile of methods for finding stuff.
All of this piled up before <a href="http://jquery.com/">jQuery</a> appeared
on a mountaintop to give us the revelation that <em>Thou Shalt Find Nodes By
Using CSS Selectors</em>. With the One True Way in hand, we’ve stripped it
down to just two (!) methods: <code>querySelector()</code> and <code>querySelectorAll()</code>.</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Old:
getElementsById()
getElementsByTagName()
getElementsByName()
getElementsByClassName()
querySelector()
querySelectorAll()
document.links
document.images
document.forms
document.scripts
formElement.elements
selectElement.options</pre>

    </div>

    <div class="col-md-6">

      <pre class="prettyprint lang-dart">// New:
querySelector()
querySelectorAll()</pre>

    </div>
  </div>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Old:
elem.getElementById('foo');
elem.getElementsByTagName('div');
elem.getElementsByName('foo');
elem.getElementsByClassName('foo');
elem.querySelector('.foo .bar');
elem.querySelectorAll('.foo .bar');</pre>

    </div>
    <div class="col-md-6">

      <!--- BEGIN(element_query) -->
      <pre class="prettyprint lang-dart">// New:
elem.querySelector('#foo');
elem.querySelectorAll('div');
elem.querySelectorAll('[name=&quot;foo&quot;]');
elem.querySelectorAll('.foo');
elem.querySelector('.foo .bar');
elem.querySelectorAll('.foo .bar');</pre>
      <!--- END(element_query) -->

    </div>
  </div>

  <h2 id="real-collections">Real collections</h2>

  <p>In JavaScript, the DOM collection types are different from the built-in
Array type, which trips users up when methods they use on one aren’t available
on the other. For Dart, we’ve cleaned that up. Methods like
<code>children</code>, <code>nodes</code>, and <code>querySelectorAll()</code> return
<em>actual</em>
Dart <a href="http://api.dartlang.org/docs/releases/latest/dart_core/List.html">lists</a>,
<a href="http://api.dartlang.org/docs/releases/latest/dart_core/Map.html">maps</a>,
and <a href="http://api.dartlang.org/docs/releases/latest/dart_core/Set.html">sets</a>.</p>

  <pre class="prettyprint lang-dart">// From dart:html
List&lt;Element&gt; querySelectorAll(String selector);

// On Element:
Map&lt;String, String&gt; attributes

List&lt;Element&gt; children

CssClassSet classes // CssClassSet implements Set&lt;String&gt;

Map&lt;String, String&gt; dataset

List&lt;Node&gt; nodes</pre>

  <p>Building on top of Dart’s collection types lets us get rid of a bunch of
special-case methods too. Instead of a bunch of methods on <code>Element</code>
for working with attributes, we just made <code>attributes</code> a map:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Old:
elem.hasAttribute('name');
elem.getAttribute('name')
elem.setAttribute('name', 'value');
elem.removeAttribute('name');</pre>

    </div>

    <div class="col-md-6">

      <!--- BEGIN(element_attributes) -->
      <pre class="prettyprint lang-dart">// New:
elem.attributes.containsKey('name');
elem.attributes['name'];
elem.attributes['name'] = 'value';
elem.attributes.remove('name');</pre>
      <!--- END(element_attributes) -->

    </div>
  </div>

  <p>Likewise, by making <code>nodes</code> and <code>children</code>
full-featured collections, we can get rid of a bunch of methods on
<code>Element</code> and <code>Node</code>:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Old:
elem.hasChildNodes();
elem.firstChild();
elem.appendChild(child);</pre>

    </div>

    <div class="col-md-6">

      <!--- BEGIN(element_nodes) -->
      <pre class="prettyprint lang-dart">// New:
elem.nodes.isEmpty;
elem.nodes[0];
elem.nodes.add(child);</pre>
      <!--- END(element_nodes) -->

    </div>
  </div>

  <h2 id="constructors">Constructors</h2>

  <p>In order to create new instances of DOM types, in traditional web programming
you’re forced to go through
factory methods on the document.</p>

  <p>Dart is a <em>class-based</em> object-oriented language. We have constructors,
and we like constructors.</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Old:
document.createElement('div');</pre>

    </div>

    <div class="col-md-6">

      <!--- BEGIN(element_constructors) -->
      <pre class="prettyprint lang-dart">// New:
new DivElement();
new ButtonElement();
new InputElement(); 
new InputElement(type: 'checkbox');
new TableElement();
new StyleElement();</pre>
      <!--- END(element_constructors) -->

    </div>
  </div>

  <p>Most of the HTML elements have constructors. For example:</p>

  <ul>
    <li><code>new ButtonElement()</code></li>
    <li><code>new InputElement()</code> or <code>new InputElement(type: 'checkbox')</code></li>
    <li><code>new TableElement()</code></li>
    <li><code>new StyleElement()</code></li>
    <li>Many more</li>
  </ul>

  <p>You can even construct an element, and its children,
from an HTML snippet. Here’s an example:</p>

  <!--- BEGIN(element_table) -->
  <pre class="prettyprint lang-dart">TableElement table = new Element.html(
    '&lt;table&gt;&lt;tr&gt;&lt;td&gt;Hello &lt;em&gt;Dart!&lt;/em&gt;&lt;/table&gt;');</pre>
  <!--- END(element_table) -->

  <p>Dart’s <a href="/docs/dart-up-and-running/contents/ch02.html#ch02-constructors-named">named constructors</a>
make it easier to conjure up DOM objects in a
variety of ways.</p>

  <h2 id="events">Events</h2>

  <p>Events are perhaps the biggest change, and I think the most useful one. We’ve
cleaned up how event handlers are bound. The DOM has two ways of working with
events. The old way is that you can bind a single handler by setting one of the
<code>on___</code> properties on the element directly. (For mysterious reasons, these are
named <code>allinlowercase</code> unlike the rest of the DOM.)</p>

  <p>The more modern way is by using <code>addEventListener()</code> and
<code>removeEventListener()</code>. That safely allows multiple listeners
for the same event, which is great, but it’s painfully verbose. You also
identify the event type by its string name, which is error-prone and doesn’t
play nice with the type system.</p>

  <p><strong>We’ve simplified things.</strong> We killed all of the <code>on___</code> properties
on Element and then used the
<a href="http://api.dartlang.org/docs/releases/latest/dart_async/Stream.html">Stream API</a>
for a unified event model. For each of the known
event types, there is a property on that class: <code>onClick</code>,
<code>onMouseDown</code>, etc. Each of those properties is a Stream object
that can register listeners and dispatch events.</p>

  <p>Here’s an example:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Old:
elem.addEventListener('click',
    (event) =&gt; print('click!'), false);

elem.removeEventListener(
    'click', listener);</pre>

    </div>
    <div class="col-md-6">

      <!--- BEGIN(element_listen) -->
      <pre class="prettyprint lang-dart">// New:
var subscription = elem.onClick.listen(
    (event) =&gt; print('click!'));

subscription.cancel();</pre>
      <!--- END(element_listen) -->

    </div>
  </div>

  <p>If you know you’re going to handle one-and-only-one event, you can
use <code>onEvent.first.then()</code>, which converts a Stream into a single event
that returns a Future.</p>

  <!--- BEGIN(handleMouseDown) -->
  <pre class="prettyprint lang-dart">void handleMouseDown(e) {
  // Gets the first mouse up event, then automatically unregisters!
  elem.onMouseUp.first.then((event) =&gt; doCoolStuff());
}</pre>
  <!--- END(handleMouseDown) -->

  <p>On the off chance that you <em>do</em> want to register a dynamically-named
event, or work with events generically, we also put a subscript operator on
<a href="http://api.dartlang.org/docs/releases/latest/dart_html/Events.html">Events</a>:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Old:
elem.addEventListener(
    'some' + 'name',
    (event) =&gt; print('dynamic!'),
    false);</pre>

    </div>
    <div class="col-md-6">

      <!--- BEGIN(element_listen_dynamic) -->
      <pre class="prettyprint lang-dart">// New:
elem.on['dynamiceventname'].listen(
    (event) =&gt; print('dynamic!'));</pre>
      <!--- END(element_listen_dynamic) -->

    </div>
  </div>

  <p>Usage of the Stream API for events is not limited to Elements.
For example, Document has <code>onReadyStateChange</code>,
<code>onSelectionChange</code>, and more.</p>

  <h2 id="no-more-vendor-prefixes">No more vendor prefixes</h2>

  <p>Vendor prefixes have a mildly contentious history on the web. Originally
a way for browser vendors to experiment with features, over time some
vendor-prefixed properties became de-facto standards due to wide deployment and
misinterpretation by developers.</p>

  <p><strong>Dart hides vendor prefixes!</strong> No more explicit cross-browser code to enable
a feature across implementations. Dart’s HTML library takes care of it for you.</p>

  <p>Here’s one example for <code>getUserMedia</code>:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Traditionally:
navigator.getMedia = ( navigator.getUserMedia ||
                       navigator.webkitGetUserMedia ||
                       navigator.mozGetUserMedia ||
                       navigator.msGetUserMedia);</pre>

    </div>
    <div class="col-md-6">

      <pre class="prettyprint lang-dart">// With Dart:
window.navigator.getUserMedia(audio:true, video: true) ...</pre>

    </div>
  </div>

  <p>Here’s <code>indexedDB</code>:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">window.indexedDB = window.indexedDB ||
                   window.mozIndexedDB ||
                   window.webkitIndexedDB ||
                   window.msIndexedDB;</pre>

    </div>
    <div class="col-md-6">

      <pre class="prettyprint lang-dart">// With Dart:
window.indexedDB.open(...)</pre>

    </div>
  </div>

  <h2 id="future-based-apis">Future-based APIs</h2>

  <p>Ah, callbacks. Sigh. Traditional web programming was littered with callback
functions as a way to write asynchronous programs. However, as apps scaled up in
complexity and number of lines of code, nested (sometimes, deeply nested)
callback functions created hard-to-read programs and hard-to-follow logic.
There’s even an entire site called <a href="http://callbackhell.com/">Callback Hell</a>
with mitigation strategies.</p>

  <p>Dart introduced the Future class for encapsulated, object-oriented asynchronous
results. A Future represents a value that is computed and returned in the future
(in a future event loop iteration). With the Future class baked into the
platform, Dart’s HTML libraries can remove the callbacks and instead return a
Future.</p>

  <p>Compare and contrast <code>getUserMedia</code>’s traditional interface and
its new Future-based interface from Dart:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Traditionally:
navigator.getMedia = ( navigator.getUserMedia ||
                       navigator.webkitGetUserMedia ||
                       navigator.mozGetUserMedia ||
                       navigator.msGetUserMedia);

navigator.getMedia (
 
   // constraints
   {
      video: true,
      audio: true
   },
 
   // successCallback
   function(localMediaStream) {
      var video = document.querySelector('video');
      video.src = window.URL.createObjectURL(localMediaStream);
      video.onloadedmetadata = function(e) {
         // Do something with the video here.
      };
   },
 
   // errorCallback
   function(err) {
    console.log(&quot;The following error occured: &quot; + err);
   }
 
);</pre>

    </div>
    <div class="col-md-6">

      <!--- BEGIN(element_get_user_media) -->
      <pre class="prettyprint lang-dart">// With Dart:
window.navigator.getUserMedia(audio:true, video: true)
  .then((stream) {
    var video = new VideoElement()
      ..autoplay = true
      ..src = Url.createObjectUrl(stream)
      ..onLoadedMetadata.listen((e) =&gt; print(e));
    document.body.append(video);
  })
  .catchError(reportIssue);</pre>
      <!--- END(element_get_user_media) -->

    </div>
  </div>

  <p>Here is IndexedDB, all Future-ized:</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-javascript">// Traditionally:
window.indexedDB = window.indexedDB ||
                   window.mozIndexedDB ||
                   window.webkitIndexedDB ||
                   window.msIndexedDB;

var request = window.indexedDB.open(&quot;MyTestDatabase&quot;);
request.onerror = function(event) {
  // Do something with request.errorCode!
};
request.onsuccess = function(event) {
  // Do something with request.result!
};
request.onupgradeneeded = function(event) { 
   // Update object stores and indices .... 
};

// on success...
db.transaction(&quot;customers&quot;)
  .objectStore(&quot;customers&quot;)
  .get(&quot;444-44-4444&quot;)
  .onsuccess = function(event) {
  alert(&quot;Name for SSN 444-44-4444 is &quot; + event.target.result.name);
};</pre>

    </div>
    <div class="col-md-6">

      <!--- BEGIN(element_indexdb) -->
      <pre class="prettyprint lang-dart">// With Dart:
window.indexedDB.open(dbName, version: version,
  onUpgradeNeeded: (e) {
    Database db = e.target.result;
    if (!db.objectStoreNames.contains(storeName)) {  
      db.createObjectStore(storeName);
    }
  })
  .then((db) {
    var txn = db.transaction(&quot;customers&quot;, &quot;readwrite&quot;);
    var store = txn.objectStore(&quot;customers&quot;);
    return store.getObject(&quot;444-44-4444&quot;);
  })
  .then((obj) =&gt; displayObject(obj))
  .catchError((e) =&gt; reportError(e));</pre>
      <!--- END(element_indexdb) -->

    </div>
  </div>

  <p>Futures show up in many more places, especially where callbacks were
previously used.</p>

  <h2 id="more-granular-libraries">More granular libraries</h2>

  <p>The original DOM libraries all live in the same namespace. This means WebGL and
SVG have to share names with elements and events. This forced namespacing into
the class and function names. For example, all class names for SVG were prefixed
with, you guessed it, “SVG”.</p>

  <p>Dart supports real libraries, so it can take large sections of the DOM
interface and give it a proper namespace. This makes <code>dart:html</code> more
lightweight, too.</p>

  <p>We started with <code>dart:svg</code>, which puts all the SVG classes together and removes
the SVG prefix from the class names. We didn’t stop with SVG. Dedicated DOM
libraries include:</p>

  <ul>
    <li><code>dart:indexed_db</code></li>
    <li><code>dart:web_audio</code></li>
    <li><code>dart:web_sql</code></li>
    <li><code>dart:svg</code></li>
  </ul>

  <p>We anticipate more libraries to be created over time.</p>

  <h2 id="cross-browser-consistency">Cross-browser consistency in HTML APIs</h2>

  <p>When was the last time you had to write browser-specific variations of your
code so that your website would behave similarly on each browser?
Probably the last time you wrote code for the web!</p>

  <p>Dart strives to provide consistency in behavior across browsers so that you
don’t have to worry about these details. While this is still a work in
progress, you will probably find yourself worrying less about browser
specifics when using the Dart HTML libraries.</p>

  <p>One such example is the <code>KeyboardEventController</code> class, which
provides better support for keyboard events on international keyboard
variants. Another example is <code>requestAnimationFrame()</code>, which
does the right thing even if the browser hasn’t implemented the function.</p>

  <h2 id="cascades">Cascaded DOM construction</h2>

  <p>Building DOM elements, complete with IDs, classes, event listeners, and more,
can lead to cumbersome and repetative blocks of code.</p>

  <p>Some libraries, like jQuery, popularized <em>method chaining</em> as a way to
simplify code. However, the API must be designed for chaining by returning
<em>this</em> from every method, which is not always appropriate nor possible.</p>

  <p>Luckily, Dart has <em>method cascades</em>, a language feature to help simplify
builder-type APIs like the DOM.</p>

  <div class="row">
    <div class="col-md-6">

      <pre class="prettyprint lang-dart">// Without cascades:
var button = new ButtonElement();
button.id = 'register';
button.classes.add('important');
button.text = 'Click to Register';
button.onClick.listen((e) =&gt; registerAccount());</pre>

    </div>
    <div class="col-md-6">

      <!--- BEGIN(element_cascades) -->
      <pre class="prettyprint lang-dart">// With cascades:
var button = new ButtonElement()
  ..id = 'register'
  ..classes.add('important')
  ..text = 'Click to Register'
  ..onClick.listen((e) =&gt; registerAccount());</pre>
      <!--- END(element_cascades) -->

    </div>
  </div>

  <h2 id="know-more">Want to know more?</h2>

  <p>Check out the
<a href="http://api.dartlang.org/docs/releases/latest/dart_html.html">dart:html API docs</a>.</p>

  <p>Speaking of browser programming, you might be interested in our
<a href="/articles/dart-web-components/">Web UI</a>
libraries that build on Web Components and provide live, two-way data binding.</p>
</div>

    	  </div> <!-- End of content from toc.html -->
        </article>
	  </div>

	
	<ul class="pager">
	  <li><a href="/articles/">关于 Dart 的更多文章 <i class="glyphicon glyphicon-chevron-up"></i></a></li>
	 </ul>
	 

	</div>
  </div>
</div>

  <footer class="footer container-full">
    <div class="container">
      <div class="row">
        <div class="col-md-5">
          <h3>一种用于创建可扩展 web 应用程序的语言、工具和代码库</h3>
          <p>Dart 是一个 <a href="https://code.google.com/p/dart/">开源项目</a>，由  Google 和其他人员参与。</p>
          <p class="sm">除非注明，该页面内容使用 the Creative Commons Attribution 3.0 License 发布，示例代码使用  BSD License 发布。</p>
          <!-- 
          <p><a class="saelogo" href="http://sae.sina.com.cn/activity/invite/15649/weibo" target="_blank"><img src="http://static.sae.sina.com.cn/image/poweredby/poweredby.png" title="Powered by Sina App Engine"></a></p>     	
          -->
        </div>
        <div class="col-md-2 col-md-offset-1">
          <h4>受欢迎的文章</h4>
          <ul>
            <li><a href="/polymer-dart/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">Polymer.dart</a></li>
            <li><a href="/performance/">性能</a></li>
            <li><a href="/docs/dart-up-and-running/contents/ch02.html?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">语言概览</a> &amp;
            <a href="/docs/dart-up-and-running/contents/ch03.html?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">代码库概览</a></li>
            <li><a href="/samples/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">示例代码</a></li>
            <li><a href="/docs/tutorials/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">教程</a> &amp;
                <a href="/codelabs/darrrt/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">代码实验室</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4>资源</h4>
          <ul>
            <li><a href="http://pub.dartlang.org/">Pub packages</a></li>
            <li><a href="/docs/synonyms/">和其他语言的相同点</a></li>
            <li><a href="http://code.google.com/p/dart/issues/list">Dart bugs and feature requests</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4>社区</h4>
          <ul>
            <li><a href="/support/">邮件列表</a></li>
            <li><a href="http://forum.dartlang.cc">中文社区</a></li>
            <li><a href="http://weibo.com/cndart">中文微博</a></li>
            <li><a href="https://plus.google.com/communities/114566943291919232850">G+ 社区</a></li>
            <li><a href="https://plus.google.com/+dartlang/posts">G+ 新闻发布频道</a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/dart">Stack Overflow</a></li>
          </ul>
        </div>
      </div>
    </div>
  </footer> <!-- End footer -->

<style>
#survey-prompt {
text-align: center;
position: fixed;
bottom: 0px;
left: 0px;
background: #00A4E4;
color: white;
font-size: 15px;
padding: 5px 70px;
z-index: 3000;
text-decoration: none;
border-radius: 0 5px 0 0;
}
</style>

<a href="//goo.gl/wpc0hL" target="_blank" id="survey-prompt">
填写一个两分钟开发者问卷调查。<br>
帮助 Dart 开发团队制定 2014 年度计划。
</a>

<script type='text/javascript' src='/js/jquery.js'></script>
<script type='text/javascript' src='/js/bootstrap.min.js'></script>
<script type='text/javascript' src='/js/prettify.js'></script>
<script type='text/javascript' src='/js/lang-dart.js'></script>
<script type='text/javascript' src='/js/lang-yaml.js'></script>
<script type='text/javascript' src='/js/scripts.js'></script>




<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F76b2695e71e6cec6e6af036d76afa367' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=1&amp;pos=left&amp;uid=590574" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
var bds_config={"bdTop":367};
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
</script>
<!-- Baidu Button END -->
</body>
</html>

